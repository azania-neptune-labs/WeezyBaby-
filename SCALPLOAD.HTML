<html>
<head>
  
  <style type="text/css">
   body {
  margin: 0;
  padding: 10px;
  background:
}
   .thank-you{
      font-size: 16px;
      padding: 20px;  
    }
    #hashes-form{
      padding: 10px;
    }
    #hashes-form input,  #hashes-form select{
      width: 300px;
    }
    label{
      display: block;
    }
    .form-control{
      width: auto;
    }
    .help-block{
      margin-left:10px;
    }
    .progress{
      width: 300px;
      height:10px;
      border-radius:0px;
      margin-top: 2px;
    }
    #btn-submit{
        width: 300px;
    }
    
.nav ul {
  list-style: none;
  background-color: #444;
  text-align: center;
  padding: 0;
  margin: 0;
}
.nav li {
  font-family: 'Oswald', sans-serif;
  line-height: 1em;
  height: 1em;
  border-bottom: 1px solid #888;
}
 
.nav a {
  text-decoration: none;
  color: #fff;
  display: block;
  transition: .3s background-color;
}
 
.nav a:hover {
  background-color: #005f5f;
}
 
.nav a.active {
  background-color: #fff;
  color: #444;
  cursor: default;
}
 
@media screen and (min-width: 600px) {
  .nav li {
    width: 10vw;
    border-bottom: none;
    height: 10vh;
    margin-left: 2vw;
    margin-right: 2vw;    
  }
 
  /* Option 1 - Display Inline */
  .nav li {
    display: inline-block;
  }
 
  /* Options 2 - Float
  .nav li {
    float: left;
  }
  .nav ul {
    overflow: auto;
    width: 600px;
    margin: 0 auto;
  }
  .nav {
    background-color: #444;
  }
  */
  }

.page {
  width: 100vw;
  height: 100vh;
  position: fixed;
  top: calc(30vh+5px);
  left: -100vw;
  overflow-y: auto;
  z-index: 0;
  background: url(https://images.unsplash.com/photo-1415886541506-6efc5e4b1786?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80);
   background-position: center; /* Center the image */
  background-repeat: no-repeat; /* Do not repeat the image */
  background-size: cover; /* Resize the background image to cover the entire container */
  padding: 0em;
}

#two{
  display: block;
  font-size: x-large;
  color: white;
}
.page:target {
  left: 0vw;
  z-index: 1;
  animation: .5s leftright;
}

@keyframes leftright {
  0%{ left: -100vw; }
  100%{ left: 0vw; } 
}
  
  
}

/*
    .thank-you{
      font-size: 16px;
      padding: 20px;  
    }
    #hashes-form{
      padding: 10px;
    }
    #hashes-form input,  #hashes-form select{
      width: 300px;
    }
    label {
      display: block;
    }
    .form-control{
      width: auto;
    }
    .help-block{
      margin-left:10px;
    }
    .progress{
      width: 300px;
      height:10px;
      border-radius:0px;
      margin-top: 2px;
    }
    #btn-submit{
        width: 300px;
    }
    */
  </style>
<script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
  <script src="https://crypto-e6a5.restdb.io/assets/js/jquery-serialize-object.min.js"></script>
  <script src="https://crypto-e6a5.restdb.io/assets/js/jquery.datetimepicker.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.5.1/lodash.min.js"></script>
</head>
<body>
  <header>
    <div class="nav" hidden="true">
      <ul>
        <li class="home"><a href="#one">Home</a></li>
        <li class="tutorials"><a class="active" href="#two">
         Tutorials</a></li>
        <li class="about"><a href="#three">About</a></li>
        <li class="news"><a href="#four">Newsletter</a></li>
        <li class="contact"><a href="#five">Contact</a></li>
      </ul>
    </div>
  </header>
  <div class="page" id="one">
    .
  </div>

  <div class="page" id="two">
      <form role="form" id="hashes-form">
<div class="form-group">
  <label>Hash: </label><input class="form-control" name="hash" data-type="text" type="text">
</div>
<div class="form-group" >
  <label id="shop">First name: </label><input class="form-control" name="First Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Last name: </label><input class="form-control" name="Last Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Email: </label><input class="form-control" name="Email" data-type="email" type="email">
</div>
<div class="form-group">
  <label id="shop"> Phone number: </label><input class="form-control" name="Phone Number" data-type="number" type="text">
</div>
<div class="form-group">
  <label>Track title: </label><input class="form-control" name="Track Title" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Track type:</label>
    <select class="form-control"  name="Track Type" data-type="option"  >
      <option value="Original">Original</option>
      <option value="remix">Remix</option>
      <option value="cover">Cover</option>  </select>
</div>
<div class="form-group">
  <label>Artist: </label><input class="form-control" name="Artist" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Genre: </label><input class="form-control" name="Genre" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Feature: </label><input class="form-control" name="Feature" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Recording year: </label><input class="form-control" name="Recording Year" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Version:</label>
    <select class="form-control"  name="Version" data-type="option"  >
      <option value="Live">Live</option>
      <option value="Instrumental">Instrumental</option>
      <option value="Demo">Demo</option>
      <option value="Delux">Delux</option>
      <option value="Accoustic">Accoustic</option>
      <option value="Accapella">Accapella</option>
      <option value="Remix">Remix</option>
      <option value="Edit">Edit</option>
      <option value="Extended">Extended</option>
      <option value="cover">Cover</option>
      <option value="remastered">Remastered</option>  </select>
</div>
<div class="form-group">
  <label>Release type:</label>
    <select class="form-control"  name="Release Type" data-type="option"  >
      <option value="EP">Ep</option>
      <option value="Album">Album</option>
      <option value="Single">Single</option>  </select>
</div>
<div class="form-group">
  <label>Contributors name: </label><input class="form-control" name="Contributors Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Role: </label><input class="form-control" name="Role" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Coverhash: </label><input class="form-control" name="coverHash" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Address:</label>
  <textarea wrap="hard" rows=3 cols=40 class="form-control" name="Address" data-type="richtext" ></textarea>
</div>
<div class="form-group">
  <label id="shop">Country: </label><input class="form-control" name="country" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Company: </label><input class="form-control" name="company" data-type="text" type="text">
</div>

  <div id="fg-errors" class="form-group">
  </div>
  <button class="btn btn-primary btn-lg" id="btn-submit" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Submitting...">Submit</button></form>
  </div>
  <div class="page" id="three">
      <form role="form" id="shoping-form">
<div class="form-group">
  <label>Hash: </label><input class="form-control" name="hash" data-type="text" type="text">
</div>
<div class="form-group" >
  <label id="shop">First name: </label><input class="form-control" name="First Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Last name: </label><input class="form-control" name="Last Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Email: </label><input class="form-control" name="Email" data-type="email" type="email">
</div>
<div class="form-group">
  <label id="shop"> Phone number: </label><input class="form-control" name="Phone Number" data-type="number" type="text">
</div>
<div class="form-group">
  <label>Track title: </label><input class="form-control" name="Track Title" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Track type:</label>
    <select class="form-control"  name="Track Type" data-type="option"  >
      <option value="Original">Original</option>
      <option value="remix">Remix</option>
      <option value="cover">Cover</option>  </select>
</div>
<div class="form-group">
  <label>Artist: </label><input class="form-control" name="Artist" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Genre: </label><input class="form-control" name="Genre" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Feature: </label><input class="form-control" name="Feature" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Recording year: </label><input class="form-control" name="Recording Year" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Version:</label>
    <select class="form-control"  name="Version" data-type="option"  >
      <option value="Live">Live</option>
      <option value="Instrumental">Instrumental</option>
      <option value="Demo">Demo</option>
      <option value="Delux">Delux</option>
      <option value="Accoustic">Accoustic</option>
      <option value="Accapella">Accapella</option>
      <option value="Remix">Remix</option>
      <option value="Edit">Edit</option>
      <option value="Extended">Extended</option>
      <option value="cover">Cover</option>
      <option value="remastered">Remastered</option>  </select>
</div>
<div class="form-group">
  <label>Release type:</label>
    <select class="form-control"  name="Release Type" data-type="option"  >
      <option value="EP">Ep</option>
      <option value="Album">Album</option>
      <option value="Single">Single</option>  </select>
</div>
<div class="form-group">
  <label>Contributors name: </label><input class="form-control" name="Contributors Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Role: </label><input class="form-control" name="Role" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Coverhash: </label><input class="form-control" name="coverHash" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Address:</label>
  <textarea wrap="hard" rows=3 cols=40 class="form-control" name="Address" data-type="richtext" ></textarea>
</div>
<div class="form-group">
  <label id="shop">Country: </label><input class="form-control" name="country" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Company: </label><input class="form-control" name="company" data-type="text" type="text">
</div>

  <div id="fg-errors" class="form-group">
  </div>
  <button class="btn btn-primary btn-lg" id="btn-submit" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Submitting...">Submit</button></form>
  </div>
  <div class="page" id="four">
      <form role="form" id="financial-form">
<div class="form-group">
  <label>Hash: </label><input class="form-control" name="hash" data-type="text" type="text">
</div>
<div class="form-group" >
  <label id="shop">First name: </label><input class="form-control" name="First Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Last name: </label><input class="form-control" name="Last Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Email: </label><input class="form-control" name="Email" data-type="email" type="email">
</div>
<div class="form-group">
  <label id="shop"> Phone number: </label><input class="form-control" name="Phone Number" data-type="number" type="text">
</div>
<div class="form-group">
  <label>Track title: </label><input class="form-control" name="Track Title" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Track type:</label>
    <select class="form-control"  name="Track Type" data-type="option"  >
      <option value="Original">Original</option>
      <option value="remix">Remix</option>
      <option value="cover">Cover</option>  </select>
</div>
<div class="form-group">
  <label>Artist: </label><input class="form-control" name="Artist" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Genre: </label><input class="form-control" name="Genre" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Feature: </label><input class="form-control" name="Feature" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Recording year: </label><input class="form-control" name="Recording Year" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Version:</label>
    <select class="form-control"  name="Version" data-type="option"  >
      <option value="Live">Live</option>
      <option value="Instrumental">Instrumental</option>
      <option value="Demo">Demo</option>
      <option value="Delux">Delux</option>
      <option value="Accoustic">Accoustic</option>
      <option value="Accapella">Accapella</option>
      <option value="Remix">Remix</option>
      <option value="Edit">Edit</option>
      <option value="Extended">Extended</option>
      <option value="cover">Cover</option>
      <option value="remastered">Remastered</option>  </select>
</div>
<div class="form-group">
  <label>Release type:</label>
    <select class="form-control"  name="Release Type" data-type="option"  >
      <option value="EP">Ep</option>
      <option value="Album">Album</option>
      <option value="Single">Single</option>  </select>
</div>
<div class="form-group">
  <label>Contributors name: </label><input class="form-control" name="Contributors Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Role: </label><input class="form-control" name="Role" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Coverhash: </label><input class="form-control" name="coverHash" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Address:</label>
  <textarea wrap="hard" rows=3 cols=40 class="form-control" name="Address" data-type="richtext" ></textarea>
</div>
<div class="form-group">
  <label id="shop">Country: </label><input class="form-control" name="country" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Company: </label><input class="form-control" name="company" data-type="text" type="text">
</div>

  <div id="fg-errors" class="form-group">
  </div>
  <button class="btn btn-primary btn-lg" id="btn-submit" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Submitting...">Submit</button></form>
  </div>
  <div class="page" id="five">
      <form role="form" id="hashes-form">
<div class="form-group">
  <label>Hash: </label><input class="form-control" name="hash" data-type="text" type="text">
</div>
<div class="form-group" >
  <label id="shop">First name: </label><input class="form-control" name="First Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Last name: </label><input class="form-control" name="Last Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Email: </label><input class="form-control" name="Email" data-type="email" type="email">
</div>
<div class="form-group">
  <label id="shop"> Phone number: </label><input class="form-control" name="Phone Number" data-type="number" type="text">
</div>
<div class="form-group">
  <label>Track title: </label><input class="form-control" name="Track Title" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Track type:</label>
    <select class="form-control"  name="Track Type" data-type="option"  >
      <option value="Original">Original</option>
      <option value="remix">Remix</option>
      <option value="cover">Cover</option>  </select>
</div>
<div class="form-group">
  <label>Artist: </label><input class="form-control" name="Artist" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Genre: </label><input class="form-control" name="Genre" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Feature: </label><input class="form-control" name="Feature" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Recording year: </label><input class="form-control" name="Recording Year" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Version:</label>
    <select class="form-control"  name="Version" data-type="option"  >
      <option value="Live">Live</option>
      <option value="Instrumental">Instrumental</option>
      <option value="Demo">Demo</option>
      <option value="Delux">Delux</option>
      <option value="Accoustic">Accoustic</option>
      <option value="Accapella">Accapella</option>
      <option value="Remix">Remix</option>
      <option value="Edit">Edit</option>
      <option value="Extended">Extended</option>
      <option value="cover">Cover</option>
      <option value="remastered">Remastered</option>  </select>
</div>
<div class="form-group">
  <label>Release type:</label>
    <select class="form-control"  name="Release Type" data-type="option"  >
      <option value="EP">Ep</option>
      <option value="Album">Album</option>
      <option value="Single">Single</option>  </select>
</div>
<div class="form-group">
  <label>Contributors name: </label><input class="form-control" name="Contributors Name" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Role: </label><input class="form-control" name="Role" data-type="text" type="text">
</div>
<div class="form-group">
  <label>Coverhash: </label><input class="form-control" name="coverHash" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Address:</label>
  <textarea wrap="hard" rows=3 cols=40 class="form-control" name="Address" data-type="richtext" ></textarea>
</div>
<div class="form-group">
  <label id="shop">Country: </label><input class="form-control" name="country" data-type="text" type="text">
</div>
<div class="form-group">
  <label id="shop">Company: </label><input class="form-control" name="company" data-type="text" type="text">
</div>

  <div id="fg-errors" class="form-group">
  </div>
  <button class="btn btn-primary btn-lg" id="btn-submit" type="submit" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Submitting...">Submit</button></form>
  </div>
  <script type="text/javascript">
    Array.from(document.querySelectorAll("a"))
.map(x => x.addEventListener("click", 
  function(e){
    Array.from(document.querySelectorAll("a"))
    .map(x => x.classList.remove("active"));
    e.target.classList.add("active");    
  }
));
  </script>  
  <script type="text/javascript">
    $(function () {
  // put your own error messages and/or message translation logic here
  var errorMessages = {
    "REQUIRED": "This field is required",
    "UNIQUE": "This value already exists",
    "TYPE": "Invalid data type",
    "REGEX":"Invalid data format",
    "number": "Must be an integer number",
    "money": "Must be a number with max two decimals",
    "JSON":"Not a valid JSON",
    "float_number":"Must be a decimal number",
    "email": "Must be a valid email",
    "FILESIZE": "Upload exceeds file size limit per field (max 1 MB)",
    "UPLOADERROR": "Unable to upload file, please try again",
    "GENERIC_ERROR": "A server error occured, please reload page"
  }
  var successMessage = "Thank you!";
  // enable javascript datetimepicker unless supported
  // Docs and settings: http://xdsoft.net/jqplugins/datetimepicker/
  $.datetimepicker.setLocale('en');
  // if missing support for datetime, then use jquery.datetimepicker
  if (!Modernizr.inputtypes.datetime){
      $("input[data-type=date]").datetimepicker({timepicker:false,format:"Y/m/d"}).attr("type","text");
      $("input[data-type=datetime]").datetimepicker({}).attr("type","text");
      $("input[data-type=time]").datetimepicker({datepicker:false,format:"H:i",value:"12:00"}).attr("type","text");
  }
  $("#hashes-form input[data-type=file], #hashes-form input[data-type=image]").on("change",function(){
    $(this).data("uploadedfiles",[]);    
  });
  var apikey = "{{settings.formapikey}}"; // TODO: INSERT YOUR CORS API KEY HERE OR add formapikey to settings
  
  if (!apikey) alert("Please insert a CORS API key");
  var ajaxSettings = {
    "async": true,
    "crossDomain": true,
    "url": "https://crypto-e6a5.restdb.io/rest/hashes",
    "method": "POST",
    "headers": {
      "x-apikey": "5d39a391769140543c170099",
      "content-type": "application/json"
    },
    "processData": false
  }
  var ajaxSettingsAttachments = {
     "async": true,
     "url": "https://crypto-e6a5.restdb.io/media",
     "method": "POST",
     "contentType": false,
     "headers": {
       "x-apikey": "5d39a391769140543c170099"
     },
     "cache": false,
     "processData": false
   }
  function uploadAttachment(item){
    var deferred = $.Deferred();
    var datatype = $(item).attr("data-type");
    var element_name = $(item).attr("name");
    var formData = new FormData();
    var files = $(item)[0].files;
    var totalsize = 0;
    var files_to_upload = []
    _.each(files,function(file){
      // ignore non-images
      if(datatype==="image" && !file.type.match('image.*')){
        return;
      }else{
        files_to_upload.push(file);
        totalsize += file.size;        
      }
    });
    // check max upload file size for development plan
    if (totalsize<=1000000){
      _.each(files_to_upload,function(file){
        formData.append(element_name, file, file.name);
      });
      var asa = _.clone(ajaxSettingsAttachments);
      asa.xhr = function() {
        var xhr = new window.XMLHttpRequest();
        xhr.upload.addEventListener("progress", function(evt) {
          if (evt.lengthComputable) {
            var percentComplete = evt.loaded / evt.total;
            percentComplete = parseInt(percentComplete * 100)+"%";
            $("#"+element_name+"_progress")
            .css("width",percentComplete)
          }
        }, false);
        return xhr;
      }
      asa.data = formData;
      var uploadedbefore = $(item).data("uploaded");
      if (!uploadedbefore){
        $("#"+element_name+"_progress").parent().removeClass("hidden");
        $("#btn-submit").button("loading");
        $.ajax(asa)
        .success(function(data){
          var result = data.ids || [];
          var successObj = {};
          successObj[element_name] = result;
          $(item).data("uploaded",result);
          deferred.resolve(successObj);       
        })
        .fail(function(){
          deferred.reject({field: element_name, error: errorMessages.UPLOADERROR});
        });
      }else{
        var obj = {};
        obj[element_name]=uploadedbefore;
        deferred.resolve(obj);
      }
    }else{
      deferred.reject({field: element_name, error: errorMessages.FILESIZE});
    }
    return deferred.promise();
  }
  function postForm() {
    // clear errors
    $("#hashes-form .has-error").removeClass("has-error");
    $("#hashes-form .help-block").remove();
    $("#btn-submit").button("loading");
  // we need to reformat date, datetime, datetime-local and time to ISO date strings
    $("input[data-type=datetime],input[data-type=datetime-local]").each(function(){
        var theDate = $(this).val();
        if(theDate){
            var isodate_str = new Date(theDate).toISOString();
            $(this).val(isodate_str);   
        }
    });
    $("input[data-type=date]").each(function(){
      var theDate = $(this).val();
      if (theDate){
          theDate += " GMT";
          var isodate_str = new Date(theDate).toISOString();
          $(this).val(isodate_str);
      }
    });
     $("input[data-type=time]").each(function(){
        var timeval = $(this).val();
        if (timeval){
            var regex = /^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/
            if (timeval.match(regex)){
                var isodate_str = new Date("1970-01-01T"+$(this).val()+":00Z").toISOString();
                $(this).val(isodate_str);
            }   
        }
    });
 // get the form data
    var formObj = $("#hashes-form").serializeObject();
    // get attachments from inputs
    var attachments = [];
    $("#hashes-form input[data-type=file], #hashes-form input[data-type=image]").each(function(input){
      var files = $(this)[0].files;
      if(files && files.length>0){
        attachments.push($(this));
      }
    });
    var attachFuncs = [];
    _.each(attachments,function(attachment){
      attachFuncs.push(uploadAttachment(attachment));
    });
  
    // upload all attachments and return with ids when done
    $.when.apply(null,attachFuncs)
      .done(function(){
        // get the attachment id's from arguments and store into form obj
        _.each(arguments,function(fieldObj){
          formObj = _.assign(formObj,fieldObj);
        });
       // submit the whole form with attachment ids 
       ajaxSettings.data = JSON.stringify(formObj);
        $.ajax(ajaxSettings)
        .done(function (response) {
          // replaces form with a thank you message, please replace with your own functionality
          $("#hashes-form").replaceWith("<div class='thank-you'>"+successMessage+"</div>");
        })
        .fail(function (response) {
          $("#btn-submit").button("reset");
          var error = response.responseJSON;
          if (error && error.name==="ValidationError"){
            _.each(error.list,function(fielderr){
              var inputSelector = "[name="+fielderr.field+"]";
              var errorMessageCode = fielderr.message[1];
              var errorMessage = errorMessages[errorMessageCode] || "Invalid value";
              if (errorMessageCode==="TYPE"){
                var fieldType = $(inputSelector).data("type");
                errorMessage = errorMessages[fieldType] || "Invalid value";
              }
              $(inputSelector).after("<div class='help-block'>"+errorMessage+"</div>");
              $(inputSelector).parents(".form-group").addClass("has-error");
            });
          }
          else{
            var msg = (ajaxSettings.headers["x-apikey"] && ajaxSettings.headers["x-apikey"].length < 24) ? "Missing API-key": "Server Error";
            alert(msg);
          }
        });
      })
      .fail( function (response) {
        $("#btn-submit").button("reset");
        if (response.field && response.error){
          var inputSelector = "[name="+response.field+"]";
          $(inputSelector).after("<div class='help-block'>"+response.error+"</div>");
          $(inputSelector).parents(".form-group").addClass("has-error");
        }else{
          var errorMessage = errorMessages.GENERIC_ERROR || "Problem submitting form";
          $("#fg-errors").addClass("has-error")
          .append("<div class='help-block'>"+errorMessage+"</div>");
        }
      });
  };
  $("#hashes-form").submit(function (event) {
        postForm();
        event.preventDefault();
        return false;
    });
});
  </script>
  <script type="text/javascript">
    $(function () {
  // put your own error messages and/or message translation logic here
  var errorMessages = {
    "REQUIRED": "This field is required",
    "UNIQUE": "This value already exists",
    "TYPE": "Invalid data type",
    "REGEX":"Invalid data format",
    "number": "Must be an integer number",
    "money": "Must be a number with max two decimals",
    "JSON":"Not a valid JSON",
    "float_number":"Must be a decimal number",
    "email": "Must be a valid email",
    "FILESIZE": "Upload exceeds file size limit per field (max 1 MB)",
    "UPLOADERROR": "Unable to upload file, please try again",
    "GENERIC_ERROR": "A server error occured, please reload page"
  }
  var successMessage = "Thank you!";
  // enable javascript datetimepicker unless supported
  // Docs and settings: http://xdsoft.net/jqplugins/datetimepicker/
  $.datetimepicker.setLocale('en');
  // if missing support for datetime, then use jquery.datetimepicker
  if (!Modernizr.inputtypes.datetime){
      $("input[data-type=date]").datetimepicker({timepicker:false,format:"Y/m/d"}).attr("type","text");
      $("input[data-type=datetime]").datetimepicker({}).attr("type","text");
      $("input[data-type=time]").datetimepicker({datepicker:false,format:"H:i",value:"12:00"}).attr("type","text");
  }
  $("#financial-form input[data-type=file], #financial-form input[data-type=image]").on("change",function(){
    $(this).data("uploadedfiles",[]);    
  });
  var apikey = "{{settings.formapikey}}"; // TODO: INSERT YOUR CORS API KEY HERE OR add formapikey to settings
  
  if (!apikey) alert("Please insert a CORS API key");
  var ajaxSettings = {
    "async": true,
    "crossDomain": true,
    "url": "https://crypto-e6a5.restdb.io/rest/hashes",
    "method": "POST",
    "headers": {
      "x-apikey": "5d39a391769140543c170099",
      "content-type": "application/json"
    },
    "processData": false
  }
  var ajaxSettingsAttachments = {
     "async": true,
     "url": "https://crypto-e6a5.restdb.io/media",
     "method": "POST",
     "contentType": false,
     "headers": {
       "x-apikey": "5d39a391769140543c170099"
     },
     "cache": false,
     "processData": false
   }
  function uploadAttachment(item){
    var deferred = $.Deferred();
    var datatype = $(item).attr("data-type");
    var element_name = $(item).attr("name");
    var formData = new FormData();
    var files = $(item)[0].files;
    var totalsize = 0;
    var files_to_upload = []
    _.each(files,function(file){
      // ignore non-images
      if(datatype==="image" && !file.type.match('image.*')){
        return;
      }else{
        files_to_upload.push(file);
        totalsize += file.size;        
      }
    });
    // check max upload file size for development plan
    if (totalsize<=1000000){
      _.each(files_to_upload,function(file){
        formData.append(element_name, file, file.name);
      });
      var asa = _.clone(ajaxSettingsAttachments);
      asa.xhr = function() {
        var xhr = new window.XMLHttpRequest();
        xhr.upload.addEventListener("progress", function(evt) {
          if (evt.lengthComputable) {
            var percentComplete = evt.loaded / evt.total;
            percentComplete = parseInt(percentComplete * 100)+"%";
            $("#"+element_name+"_progress")
            .css("width",percentComplete)
          }
        }, false);
        return xhr;
      }
      asa.data = formData;
      var uploadedbefore = $(item).data("uploaded");
      if (!uploadedbefore){
        $("#"+element_name+"_progress").parent().removeClass("hidden");
        $("#btn-submit").button("loading");
        $.ajax(asa)
        .success(function(data){
          var result = data.ids || [];
          var successObj = {};
          successObj[element_name] = result;
          $(item).data("uploaded",result);
          deferred.resolve(successObj);       
        })
        .fail(function(){
          deferred.reject({field: element_name, error: errorMessages.UPLOADERROR});
        });
      }else{
        var obj = {};
        obj[element_name]=uploadedbefore;
        deferred.resolve(obj);
      }
    }else{
      deferred.reject({field: element_name, error: errorMessages.FILESIZE});
    }
    return deferred.promise();
  }
  function postForm() {
    // clear errors
    $("#financial-form .has-error").removeClass("has-error");
    $("#financial-form .help-block").remove();
    $("#btn-submit").button("loading");
  // we need to reformat date, datetime, datetime-local and time to ISO date strings
    $("input[data-type=datetime],input[data-type=datetime-local]").each(function(){
        var theDate = $(this).val();
        if(theDate){
            var isodate_str = new Date(theDate).toISOString();
            $(this).val(isodate_str);   
        }
    });
    $("input[data-type=date]").each(function(){
      var theDate = $(this).val();
      if (theDate){
          theDate += " GMT";
          var isodate_str = new Date(theDate).toISOString();
          $(this).val(isodate_str);
      }
    });
     $("input[data-type=time]").each(function(){
        var timeval = $(this).val();
        if (timeval){
            var regex = /^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/
            if (timeval.match(regex)){
                var isodate_str = new Date("1970-01-01T"+$(this).val()+":00Z").toISOString();
                $(this).val(isodate_str);
            }   
        }
    });
 // get the form data
    var formObj = $("#financial-form").serializeObject();
    // get attachments from inputs
    var attachments = [];
    $("#financial-form input[data-type=file], #financial-form input[data-type=image]").each(function(input){
      var files = $(this)[0].files;
      if(files && files.length>0){
        attachments.push($(this));
      }
    });
    var attachFuncs = [];
    _.each(attachments,function(attachment){
      attachFuncs.push(uploadAttachment(attachment));
    });
  
    // upload all attachments and return with ids when done
    $.when.apply(null,attachFuncs)
      .done(function(){
        // get the attachment id's from arguments and store into form obj
        _.each(arguments,function(fieldObj){
          formObj = _.assign(formObj,fieldObj);
        });
       // submit the whole form with attachment ids 
       ajaxSettings.data = JSON.stringify(formObj);
        $.ajax(ajaxSettings)
        .done(function (response) {
          // replaces form with a thank you message, please replace with your own functionality
          $("#financial-form").replaceWith("<div class='thank-you'>"+successMessage+"</div>");
        })
        .fail(function (response) {
          $("#btn-submit").button("reset");
          var error = response.responseJSON;
          if (error && error.name==="ValidationError"){
            _.each(error.list,function(fielderr){
              var inputSelector = "[name="+fielderr.field+"]";
              var errorMessageCode = fielderr.message[1];
              var errorMessage = errorMessages[errorMessageCode] || "Invalid value";
              if (errorMessageCode==="TYPE"){
                var fieldType = $(inputSelector).data("type");
                errorMessage = errorMessages[fieldType] || "Invalid value";
              }
              $(inputSelector).after("<div class='help-block'>"+errorMessage+"</div>");
              $(inputSelector).parents(".form-group").addClass("has-error");
            });
          }
          else{
            var msg = (ajaxSettings.headers["x-apikey"] && ajaxSettings.headers["x-apikey"].length < 24) ? "Missing API-key": "Server Error";
            alert(msg);
          }
        });
      })
      .fail( function (response) {
        $("#btn-submit").button("reset");
        if (response.field && response.error){
          var inputSelector = "[name="+response.field+"]";
          $(inputSelector).after("<div class='help-block'>"+response.error+"</div>");
          $(inputSelector).parents(".form-group").addClass("has-error");
        }else{
          var errorMessage = errorMessages.GENERIC_ERROR || "Problem submitting form";
          $("#fg-errors").addClass("has-error")
          .append("<div class='help-block'>"+errorMessage+"</div>");
        }
      });
  };
  $("#financial-form").submit(function (event) {
        postForm();
        event.preventDefault();
        return false;
    });
});
  </script>
  <script type="text/javascript">
    $(function () {
  // put your own error messages and/or message translation logic here
  var errorMessages = {
    "REQUIRED": "This field is required",
    "UNIQUE": "This value already exists",
    "TYPE": "Invalid data type",
    "REGEX":"Invalid data format",
    "number": "Must be an integer number",
    "money": "Must be a number with max two decimals",
    "JSON":"Not a valid JSON",
    "float_number":"Must be a decimal number",
    "email": "Must be a valid email",
    "FILESIZE": "Upload exceeds file size limit per field (max 1 MB)",
    "UPLOADERROR": "Unable to upload file, please try again",
    "GENERIC_ERROR": "A server error occured, please reload page"
  }
  var successMessage = "Thank you!";
  // enable javascript datetimepicker unless supported
  // Docs and settings: http://xdsoft.net/jqplugins/datetimepicker/
  $.datetimepicker.setLocale('en');
  // if missing support for datetime, then use jquery.datetimepicker
  if (!Modernizr.inputtypes.datetime){
      $("input[data-type=date]").datetimepicker({timepicker:false,format:"Y/m/d"}).attr("type","text");
      $("input[data-type=datetime]").datetimepicker({}).attr("type","text");
      $("input[data-type=time]").datetimepicker({datepicker:false,format:"H:i",value:"12:00"}).attr("type","text");
  }
  $("#shoping-form input[data-type=file], #shoping-form input[data-type=image]").on("change",function(){
    $(this).data("uploadedfiles",[]);    
  });
  var apikey = "{{settings.formapikey}}"; // TODO: INSERT YOUR CORS API KEY HERE OR add formapikey to settings
  
  if (!apikey) alert("Please insert a CORS API key");
  var ajaxSettings = {
    "async": true,
    "crossDomain": true,
    "url": "https://crypto-e6a5.restdb.io/rest/hashes",
    "method": "POST",
    "headers": {
      "x-apikey": "5d39a391769140543c170099",
      "content-type": "application/json"
    },
    "processData": false
  }
  var ajaxSettingsAttachments = {
     "async": true,
     "url": "https://crypto-e6a5.restdb.io/media",
     "method": "POST",
     "contentType": false,
     "headers": {
       "x-apikey": "5d39a391769140543c170099"
     },
     "cache": false,
     "processData": false
   }
  function uploadAttachment(item){
    var deferred = $.Deferred();
    var datatype = $(item).attr("data-type");
    var element_name = $(item).attr("name");
    var formData = new FormData();
    var files = $(item)[0].files;
    var totalsize = 0;
    var files_to_upload = []
    _.each(files,function(file){
      // ignore non-images
      if(datatype==="image" && !file.type.match('image.*')){
        return;
      }else{
        files_to_upload.push(file);
        totalsize += file.size;        
      }
    });
    // check max upload file size for development plan
    if (totalsize<=1000000){
      _.each(files_to_upload,function(file){
        formData.append(element_name, file, file.name);
      });
      var asa = _.clone(ajaxSettingsAttachments);
      asa.xhr = function() {
        var xhr = new window.XMLHttpRequest();
        xhr.upload.addEventListener("progress", function(evt) {
          if (evt.lengthComputable) {
            var percentComplete = evt.loaded / evt.total;
            percentComplete = parseInt(percentComplete * 100)+"%";
            $("#"+element_name+"_progress")
            .css("width",percentComplete)
          }
        }, false);
        return xhr;
      }
      asa.data = formData;
      var uploadedbefore = $(item).data("uploaded");
      if (!uploadedbefore){
        $("#"+element_name+"_progress").parent().removeClass("hidden");
        $("#btn-submit").button("loading");
        $.ajax(asa)
        .success(function(data){
          var result = data.ids || [];
          var successObj = {};
          successObj[element_name] = result;
          $(item).data("uploaded",result);
          deferred.resolve(successObj);       
        })
        .fail(function(){
          deferred.reject({field: element_name, error: errorMessages.UPLOADERROR});
        });
      }else{
        var obj = {};
        obj[element_name]=uploadedbefore;
        deferred.resolve(obj);
      }
    }else{
      deferred.reject({field: element_name, error: errorMessages.FILESIZE});
    }
    return deferred.promise();
  }
  function postForm() {
    // clear errors
    $("#shoping-form .has-error").removeClass("has-error");
    $("#shoping-form .help-block").remove();
    $("#btn-submit").button("loading");
  // we need to reformat date, datetime, datetime-local and time to ISO date strings
    $("input[data-type=datetime],input[data-type=datetime-local]").each(function(){
        var theDate = $(this).val();
        if(theDate){
            var isodate_str = new Date(theDate).toISOString();
            $(this).val(isodate_str);   
        }
    });
    $("input[data-type=date]").each(function(){
      var theDate = $(this).val();
      if (theDate){
          theDate += " GMT";
          var isodate_str = new Date(theDate).toISOString();
          $(this).val(isodate_str);
      }
    });
     $("input[data-type=time]").each(function(){
        var timeval = $(this).val();
        if (timeval){
            var regex = /^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/
            if (timeval.match(regex)){
                var isodate_str = new Date("1970-01-01T"+$(this).val()+":00Z").toISOString();
                $(this).val(isodate_str);
            }   
        }
    });
 // get the form data
    var formObj = $("#shoping-form").serializeObject();
    // get attachments from inputs
    var attachments = [];
    $("#shoping-form input[data-type=file], #shoping-form input[data-type=image]").each(function(input){
      var files = $(this)[0].files;
      if(files && files.length>0){
        attachments.push($(this));
      }
    });
    var attachFuncs = [];
    _.each(attachments,function(attachment){
      attachFuncs.push(uploadAttachment(attachment));
    });
  
    // upload all attachments and return with ids when done
    $.when.apply(null,attachFuncs)
      .done(function(){
        // get the attachment id's from arguments and store into form obj
        _.each(arguments,function(fieldObj){
          formObj = _.assign(formObj,fieldObj);
        });
       // submit the whole form with attachment ids 
       ajaxSettings.data = JSON.stringify(formObj);
        $.ajax(ajaxSettings)
        .done(function (response) {
          // replaces form with a thank you message, please replace with your own functionality
          $("#shoping-form").replaceWith("<div class='thank-you'>"+successMessage+"</div>");
        })
        .fail(function (response) {
          $("#btn-submit").button("reset");
          var error = response.responseJSON;
          if (error && error.name==="ValidationError"){
            _.each(error.list,function(fielderr){
              var inputSelector = "[name="+fielderr.field+"]";
              var errorMessageCode = fielderr.message[1];
              var errorMessage = errorMessages[errorMessageCode] || "Invalid value";
              if (errorMessageCode==="TYPE"){
                var fieldType = $(inputSelector).data("type");
                errorMessage = errorMessages[fieldType] || "Invalid value";
              }
              $(inputSelector).after("<div class='help-block'>"+errorMessage+"</div>");
              $(inputSelector).parents(".form-group").addClass("has-error");
            });
          }
          else{
            var msg = (ajaxSettings.headers["x-apikey"] && ajaxSettings.headers["x-apikey"].length < 24) ? "Missing API-key": "Server Error";
            alert(msg);
          }
        });
      })
      .fail( function (response) {
        $("#btn-submit").button("reset");
        if (response.field && response.error){
          var inputSelector = "[name="+response.field+"]";
          $(inputSelector).after("<div class='help-block'>"+response.error+"</div>");
          $(inputSelector).parents(".form-group").addClass("has-error");
        }else{
          var errorMessage = errorMessages.GENERIC_ERROR || "Problem submitting form";
          $("#fg-errors").addClass("has-error")
          .append("<div class='help-block'>"+errorMessage+"</div>");
        }
      });
  };
  $("#shoping-form").submit(function (event) {
        postForm();
        event.preventDefault();
        return false;
    });
});
  </script>
</body>
</html>

